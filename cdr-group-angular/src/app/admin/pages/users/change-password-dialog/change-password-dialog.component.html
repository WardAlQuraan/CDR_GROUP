<app-base-dialog
  [title]="'admin.users.changePassword'"
  [saveLabel]="'common.save'"
  [saveDisabled]="form.invalid || passwordsMismatch"
  [loading]="loading"
  (save)="onSubmit()"
  (cancel)="onCancel()">

  <div class="username-info">
    <mat-icon>person</mat-icon>
    <span>{{ data.username }}</span>
  </div>

  <form [formGroup]="form" class="dialog-form">
    <mat-form-field appearance="outline" class="w-100">
      <mat-label>{{ 'admin.users.newPassword' | translate }}</mat-label>
      <mat-icon matPrefix>lock</mat-icon>
      <input matInput formControlName="newPassword" [type]="hideNewPassword ? 'password' : 'text'">
      <button mat-icon-button matSuffix (click)="hideNewPassword = !hideNewPassword" type="button">
        <mat-icon>{{ hideNewPassword ? 'visibility_off' : 'visibility' }}</mat-icon>
      </button>
      @if (form.get('newPassword')?.hasError('required') && form.get('newPassword')?.touched) {
        <mat-error>{{ 'validation.required' | translate }}</mat-error>
      }
      @if (form.get('newPassword')?.hasError('minlength') && form.get('newPassword')?.touched) {
        <mat-error>{{ 'admin.users.errors.passwordMinLength' | translate }}</mat-error>
      }
    </mat-form-field>

    <mat-form-field appearance="outline" class="w-100">
      <mat-label>{{ 'admin.users.confirmPassword' | translate }}</mat-label>
      <mat-icon matPrefix>lock_outline</mat-icon>
      <input matInput formControlName="confirmPassword" [type]="hideConfirmPassword ? 'password' : 'text'">
      <button mat-icon-button matSuffix (click)="hideConfirmPassword = !hideConfirmPassword" type="button">
        <mat-icon>{{ hideConfirmPassword ? 'visibility_off' : 'visibility' }}</mat-icon>
      </button>
      @if (form.get('confirmPassword')?.hasError('required') && form.get('confirmPassword')?.touched) {
        <mat-error>{{ 'validation.required' | translate }}</mat-error>
      }
      @if (passwordsMismatch) {
        <mat-error>{{ 'admin.users.errors.passwordsMismatch' | translate }}</mat-error>
      }
    </mat-form-field>
  </form>

</app-base-dialog>
