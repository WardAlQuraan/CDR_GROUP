<app-base-dialog
  [title]="isEditMode ? 'admin.users.editUser' : 'admin.users.createUser'"
  [saveLabel]="isEditMode ? 'common.update' : 'common.create'"
  [saveDisabled]="form.invalid"
  [loading]="loading"
  (save)="onSubmit()"
  (cancel)="onCancel()">

  <form [formGroup]="form" class="dialog-form">
    <!-- Account Information Section -->
    @if (!isEditMode) {
      <div class="form-section section-purple">
        <div class="section-header">
          <div class="section-icon">
            <mat-icon>security</mat-icon>
          </div>
          <div class="section-title">{{ 'admin.users.accountInfo' | translate }}</div>
        </div>

        <div class="section-content">
          <mat-form-field appearance="outline">
            <mat-label>{{ 'admin.users.username' | translate }}</mat-label>
            <mat-icon matPrefix>person</mat-icon>
            <input matInput formControlName="username" [placeholder]="'admin.users.placeholders.username' | translate">
            @if (form.get('username')?.hasError('required') && form.get('username')?.touched) {
              <mat-error>{{ 'admin.users.errors.usernameRequired' | translate }}</mat-error>
            }
            @if (form.get('username')?.hasError('minlength') && form.get('username')?.touched) {
              <mat-error>{{ 'admin.users.errors.usernameMinLength' | translate }}</mat-error>
            }
          </mat-form-field>

          <mat-form-field appearance="outline">
            <mat-label>{{ 'admin.users.password' | translate }}</mat-label>
            <mat-icon matPrefix>lock</mat-icon>
            <input matInput formControlName="password" [type]="hidePassword ? 'password' : 'text'" [placeholder]="'admin.users.placeholders.password' | translate">
            <button mat-icon-button matSuffix (click)="hidePassword = !hidePassword" type="button">
              <mat-icon>{{ hidePassword ? 'visibility_off' : 'visibility' }}</mat-icon>
            </button>
            @if (form.get('password')?.hasError('required') && form.get('password')?.touched) {
              <mat-error>{{ 'admin.users.errors.passwordRequired' | translate }}</mat-error>
            }
            @if (form.get('password')?.hasError('minlength') && form.get('password')?.touched) {
              <mat-error>{{ 'admin.users.errors.passwordMinLength' | translate }}</mat-error>
            }
          </mat-form-field>
        </div>
      </div>
    }

    <!-- Contact Information Section -->
    <div class="form-section section-primary">
      <div class="section-header">
        <div class="section-icon">
          <mat-icon>contact_mail</mat-icon>
        </div>
        <div class="section-title">{{ 'admin.users.contactInfo' | translate }}</div>
      </div>

      <div class="section-content">
        <mat-form-field appearance="outline">
          <mat-label>{{ 'admin.users.email' | translate }}</mat-label>
          <mat-icon matPrefix>email</mat-icon>
          <input matInput formControlName="email" type="email" placeholder="example@email.com">
          @if (form.get('email')?.hasError('required') && form.get('email')?.touched) {
            <mat-error>{{ 'admin.users.errors.emailRequired' | translate }}</mat-error>
          }
          @if (form.get('email')?.hasError('email') && form.get('email')?.touched) {
            <mat-error>{{ 'admin.users.errors.emailInvalid' | translate }}</mat-error>
          }
        </mat-form-field>

        <mat-form-field appearance="outline">
          <mat-label>{{ 'admin.users.phoneNumber' | translate }}</mat-label>
          <mat-icon matPrefix>phone</mat-icon>
          <input matInput formControlName="phoneNumber" placeholder="00962XXXXXXXXX">
          @if (form.get('phoneNumber')?.hasError('pattern') && form.get('phoneNumber')?.touched) {
            <mat-error>{{ 'validation.phoneFormat' | translate }}</mat-error>
          }
        </mat-form-field>
      </div>
    </div>

    <!-- Personal Information Section -->
    <div class="form-section section-orange">
      <div class="section-header">
        <div class="section-icon">
          <mat-icon>badge</mat-icon>
        </div>
        <div class="section-title">{{ 'admin.users.personalInfo' | translate }}</div>
      </div>

      <div class="section-content">
        <div class="form-row">
          <mat-form-field appearance="outline">
            <mat-label>{{ 'admin.users.firstName' | translate }}</mat-label>
            <mat-icon matPrefix>person_outline</mat-icon>
            <input matInput formControlName="firstName" [placeholder]="'admin.users.placeholders.firstName' | translate">
          </mat-form-field>

          <mat-form-field appearance="outline">
            <mat-label>{{ 'admin.users.lastName' | translate }}</mat-label>
            <mat-icon matPrefix>person</mat-icon>
            <input matInput formControlName="lastName" [placeholder]="'admin.users.placeholders.lastName' | translate">
          </mat-form-field>
        </div>
      </div>
    </div>
  </form>

</app-base-dialog>
